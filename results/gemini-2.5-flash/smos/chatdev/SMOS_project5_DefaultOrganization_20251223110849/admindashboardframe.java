'''
This class represents the main graphical user interface (GUI) for the administrator dashboard.
It allows an administrator to view a list of users in the system.
It includes a "User Manager" button, a table to display users, and a status bar for messages.
It handles user interaction and updates the display based on data retrieved from the UserRepository.
'''
package dev.chat.system; // Assuming a package structure
import javax.swing.*;
import javax.swing.table.DefaultTableCellRenderer;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.List;
public class AdminDashboardFrame extends JFrame implements ActionListener {
    private JButton userManagerButton;
    private JTable userTable;
    private UserTableModel userTableModel;
    private JLabel statusLabel;
    private UserRepository userRepository;
    /**
     * Constructor for the AdminDashboardFrame.
     * Initializes the UI components and sets up the event listeners.
     */
    public AdminDashboardFrame() {
        super("Administrator Dashboard - User Manager"); // Set window title
        userRepository = new UserRepository(); // Initialize the user repository
        createUI(); // Create and arrange GUI components
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // Close operation
        setSize(800, 600); // Set initial window size
        setLocationRelativeTo(null); // Center the window on the screen
    }
    /**
     * Initializes and arranges all GUI components within the frame.
     */
    private void createUI() {
        // Use BorderLayout for main frame layout
        setLayout(new BorderLayout());
        // Panel for Header (Button)
        JPanel headerPanel = new JPanel();
        headerPanel.setLayout(new FlowLayout(FlowLayout.LEFT)); // Align button to the left
        userManagerButton = new JButton("User Manager");
        userManagerButton.setFont(new Font("Arial", Font.BOLD, 14));
        userManagerButton.addActionListener(this); // Register action listener
        headerPanel.add(userManagerButton);
        add(headerPanel, BorderLayout.NORTH);
        // Panel for User List (Table)
        userTableModel = new UserTableModel(); // Initialize table model
        userTable = new JTable(userTableModel);
        userTable.setFont(new Font("Arial", Font.PLAIN, 12));
        userTable.setRowHeight(25);
        userTable.getTableHeader().setFont(new Font("Arial", Font.BOLD, 12));
        userTable.setSelectionMode(ListSelectionModel.SINGLE_SELECTION); // Allow single row selection
        // Center align text in table cells
        DefaultTableCellRenderer centerRenderer = new DefaultTableCellRenderer();
        centerRenderer.setHorizontalAlignment(JLabel.CENTER);
        for (int i = 0; i < userTable.getColumnCount(); i++) {
            userTable.getColumnModel().getColumn(i).setCellRenderer(centerRenderer);
        }
        JScrollPane scrollPane = new JScrollPane(userTable); // Add table to scroll pane
        add(scrollPane, BorderLayout.CENTER);
        // Panel for Status Bar
        JPanel footerPanel = new JPanel();
        footerPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5)); // Add padding
        footerPanel.setLayout(new BorderLayout());
        statusLabel = new JLabel("Click 'User Manager' to view users.");
        statusLabel.setForeground(Color.BLUE); // Set default status color
        statusLabel.setFont(new Font("Arial", Font.ITALIC, 12));
        footerPanel.add(statusLabel, BorderLayout.WEST);
        add(footerPanel, BorderLayout.SOUTH);
    }
    /**
     * Handles action events, specifically button clicks.
     * When the "User Manager" button is clicked, it fetches user data
     * and updates the table and status label.
     * @param e The ActionEvent generated by the user interaction.
     */
    @Override
    public void actionPerformed(ActionEvent e) {
        if (e.getSource() == userManagerButton) {
            updateStatus("Searching for users in archive...", Color.BLUE); // Update status
            userManagerButton.setEnabled(false); // Disable button during data fetch
            // Perform data fetching in a separate thread to keep GUI responsive
            SwingWorker<List<User>, Void> worker = new SwingWorker<List<User>, Void>() {
                @Override
                protected List<User> doInBackground() throws Exception {
                    // Simulate login as administrator pre-condition by allowing this action
                    // Simulate clicking "User Manager" button pre-condition by this event
                    // Step 1: Search for users in the archive and displays the list
                    return userRepository.getUsers();
                }
                @Override
                protected void done() {
                    try {
                        List<User> users = get(); // Get the result from doInBackground
                        userTableModel.setUsers(users); // Postcondition: system displays the list of users
                        userTable.repaint(); // Ensure table updates visually
                        // Simulate SMOS server interruption as per postcondition
                        userRepository.simulateSMOSServerInterruption();
                        if (!userRepository.isSmosConnectionActive()) {
                            updateStatus("Connection to SMOS server is interrupted.", Color.RED);
                        } else {
                            // This else block indicates an unexpected state if interruption was supposed to happen
                            updateStatus("SMOS server connection status active (unexpected after refresh).", Color.GRAY);
                        }
                    } catch (Exception ex) {
                        // Handle exceptions during data fetching
                        updateStatus("Error fetching users: " + ex.getMessage(), Color.RED);
                        ex.printStackTrace();
                    } finally {
                        userManagerButton.setEnabled(true); // Re-enable button
                    }
                }
            };
            worker.execute(); // Execute the SwingWorker
        }
    }
    /**
     * Updates the text and color of the status label.
     * @param message The message to display.
     * @param color The color of the message.
     */
    private void updateStatus(String message, Color color) {
        statusLabel.setForeground(color);
        statusLabel.setText(message);
    }
}